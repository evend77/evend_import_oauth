<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Importer vos annonces eBay vers e-Vend</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      background: #f9f9f9;
    }
    h2 { color: #333; }
    .section {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .alert {
      background: #ffe5e5;
      border: 1px solid #ff4d4d;
      color: #b30000;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-weight: bold;
    }
    .explanation {
      background: #f0f7ff;
      border: 1px solid #cce0ff;
      color: #003366;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .explanation h3 { margin-top: 0; color: #0055aa; }
    .explanation ul { margin: 10px 0 15px 20px; }
    .help-box {
      background: #fefbea;
      border: 1px solid #e6d97c;
      color: #665c00;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      font-size: 14px;
    }
    .help-box strong { color: #b38b00; }
    label { font-weight: bold; margin-right: 10px; }
    input[type="text"], input[type="file"] {
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
      width: 250px;
    }
    input[type="file"] { width: auto; }
    button {
      margin-top: 15px;
      padding: 10px 20px;
      background-color: #0073e6;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover { background-color: #005bb5; }
    .hidden { display: none; }
  </style>
</head>
<body>

<h2>Importer vos annonces eBay vers e-Vend</h2>

<!-- Encadr√© rouge avertissements -->
<div class="alert">
  ‚ö†Ô∏è Limite par import CSV : 500 articles maximum.<br>
  ‚ö†Ô∏è Limite par jour par utilisateur : 2000 articles maximum.<br>
  ‚ö†Ô∏è Assurez-vous de g√©rer votre stock si vous vendez le m√™me article sur plusieurs marketplaces.
</div>

<!-- Section explicative -->
<div class="explanation">
  <h3>Il existe deux types de comptes eBay :</h3>
  <ul>
    <li><strong>Sans policies :</strong> compte classique, vous n‚Äôutilisez pas de politiques de vente pr√©d√©finies. Le CSV mod√®le standard suffit.</li>
    <li><strong>Avec policies :</strong> compte avanc√©, vous avez configur√© des politiques d‚Äôexp√©dition, de paiement et de retour dans eBay. Pour ce type de compte, utilisez le CSV mod√®le avec policies et renseignez vos IDs pour que l‚Äôimport fonctionne correctement.</li>
  </ul>
  <p>
    Les <em>policies</em> permettent de d√©finir automatiquement comment vos ventes sont g√©r√©es pour
    <strong>l‚Äôexp√©dition</strong>, <strong>le paiement</strong> et <strong>les retours</strong>,
    sans avoir √† saisir ces informations pour chaque article.
  </p>
</div>

<!-- √âtape 1 : Mod√®les CSV -->
<div class="section">
  <h3><strong>√âtape 1 : T√©l√©chargez notre mod√®le de CSV que eBay va remplir</strong></h3>
  <p>- Choisissez le mod√®le selon vos besoins :</p>

  <label>
    <input type="radio" name="use_policies" value="no" onclick="togglePolicyFields()">
    Sans policies
  </label>

  <label>
    <input type="radio" name="use_policies" value="yes" onclick="togglePolicyFields()">
    Avec policies
  </label>

  <!-- Section sans policies -->
  <div id="simple-fields" class="hidden" style="margin-top:15px;">
    <h4>Mod√®le CSV sans policies</h4>
    <button onclick="downloadSimpleCSV()">üì• T√©l√©charger mod√®le sans policies</button>
  </div>

  <!-- Section avec policies -->
  <div id="policy-fields" class="hidden" style="margin-top:15px;">
    <h4>Mod√®le CSV avec Business Policies</h4>
    <div>
      <label for="shipping_policy_id">Shipping Policy ID :</label>
      <input type="text" id="shipping_policy_id" placeholder="Ex: 123456">
    </div>
    <div>
      <label for="payment_policy_id">Payment Policy ID :</label>
      <input type="text" id="payment_policy_id" placeholder="Ex: 654321">
    </div>
    <div>
      <label for="return_policy_id">Return Policy ID :</label>
      <input type="text" id="return_policy_id" placeholder="Ex: 789012">
    </div>

    <!-- Encadr√© aide -->
    <div class="help-box">
      <strong>‚ÑπÔ∏è Aide pour trouver vos IDs sur eBay :</strong>
      <ol>
        <li>Connectez-vous √† votre compte eBay.</li>
        <li>En haut √† droite, ouvrez le menu "Bonjour [Votre Nom]" et cliquez sur <em>Param√®tres du compte</em>.</li>
        <li>Dans la section <em>Mes ventes</em> √† gauche, cliquez sur <em>Politiques de vente</em>.</li>
        <li>Dans le tableau, vous verrez les IDs de vos policies pour l‚Äôexp√©dition, le paiement et les retours.</li>
        <li>Copiez ces IDs dans les champs ci-dessus pour que l‚Äôimport fonctionne correctement.</li>
      </ol>
    </div>

    <button onclick="downloadPolicyCSV()">üì• T√©l√©charger mod√®le avec policies</button>
  </div>
</div>

<!-- √âtape 2 : Instructions eBay -->
<div class="section" style="background:#e0f0ff;">
  <h3><strong>√âtape 2 : Allez sur eBay pour obtenir notre CSV incluant nos annonces</strong></h3>
  <p><strong>Comment utiliser notre CSV mod√®le sur eBay :</strong></p>
  <ol>
    <li>Connectez-vous √† votre compte eBay.</li>
    <li>Cliquez sur le menu en haut √† droite <em>"Mon eBay"</em>.</li>
    <li>Dans ce menu, choisissez <em>Mes ventes</em>.</li>
    <li>Dans le menu <em>Annonce (My Listing)</em>, choisissez <em>En cours (Active Listing)</em>.</li>
    <li>S√©lectionnez les items que vous voulez inclure dans votre CSV.</li>
    <li>Cliquez sur le bouton <em>"Charger (Upload)"</em>. Une fen√™tre s‚Äôouvre.</li>
    <li>Cliquez sur <em>"Choisir le fichier"</em> et parcourez votre ordinateur pour s√©lectionner le mod√®le CSV fourni par e-Vend.</li>
    <li>Proc√©dez et enregistrez ce nouveau CSV sur votre ordinateur.</li>
  </ol>
</div>

<!-- √âtape 3 : Transfert vers e-Vend -->
<div class="section">
  <h3><strong>√âtape 3 : Transf√©rez votre CSV contenant vos annonces vers e-Vend</strong></h3>
  <form action="/upload_csv" method="POST" enctype="multipart/form-data">
    <label for="csv_file">S√©lectionnez votre fichier CSV :</label><br>
    <input type="file" id="csv_file" name="csv_file" accept=".csv" required><br>
    <button type="submit">‚û°Ô∏è Transf√©rer vers e-Vend</button>
  </form>
</div>

<!-- Notes -->
<div class="section">
  <h3><strong>Notes :</strong></h3>
  <p>
    Vous verrez des messages pendant le traitement :<br>
    ‚ÄúLot 1/N termin√©, Lot 2/N en cours‚Ä¶‚Äù<br>
    Import automatique termin√© ou erreurs d√©tect√©es.
  </p>
  <p>
    - Allez sur votre compte e-Vend ‚Üí Mes annonces.<br>
    - V√©rifiez titre, prix, description, images, stock.<br>
    - Si corrections n√©cessaires, modifiez le CSV et refaites l‚Äôimport.
  </p>
  <p>
    <strong>Conseil :</strong> conservez une copie de votre CSV rempli pour pouvoir r√©importer rapidement si besoin. Les images doivent √™tre accessibles via URL.
  </p>
</div>

<!-- Script JS -->
<script>
  function togglePolicyFields() {
    const usePolicies = document.querySelector('input[name="use_policies"]:checked').value;
    document.getElementById('policy-fields').classList.toggle('hidden', usePolicies !== 'yes');
    document.getElementById('simple-fields').classList.toggle('hidden', usePolicies === 'yes');
  }

  function downloadSimpleCSV() {
    window.location.href = `{{ url_for('download_csv_modele', mode='simple') }}`;
  }

  function downloadPolicyCSV() {
    const shipping = document.getElementById('shipping_policy_id').value;
    const payment = document.getElementById('payment_policy_id').value;
    const ret = document.getElementById('return_policy_id').value;
    const url = `{{ url_for('download_csv_modele', mode='policies') }}?shipping=${encodeURIComponent(shipping)}&payment=${encodeURIComponent(payment)}&return=${encodeURIComponent(ret)}`;
    window.location.href = url;
  }
</script>

</body>
</html>

